
#-------------------------------------------------------------------------------------#
# 0. Deployment variables setting
#-------------------------------------------------------------------------------------#
. .\00_DeployVariables.ps1

#-------------------------------------------------------------------------------------#
# 1. Build DataCenter project : creates dacpac file, next to be deployed 
#-------------------------------------------------------------------------------------#
. .\01_BuildProj.ps1

#-------------------------------------------------------------------------------------#
# 2. Set develop server objects
#-------------------------------------------------------------------------------------#
#.\02_PriorityLinkedServer.ps1

#-------------------------------------------------------------------------------------#
# 3. Deploy DataCenter project on develop server
#-------------------------------------------------------------------------------------#
. .\03_DeployProj.ps1

#-----------------------------------------------------------------------------------------------#
# 4. Enable extraction jobs
#-----------------------------------------------------------------------------------------------#
. .\04_EnableJob.ps1
#-------------------------------------------------------------------------------------#
# 5. Pre test deployments
#-------------------------------------------------------------------------------------#
# Populate tested tables by executing relevant jobs
#. .\05_PreTestProj.ps1
#do not start testing until job finishes executing and all data is loaded

#do {
#    $SQLSvrObj=New-Object Microsoft.SqlServer.Management.Smo.Server $target_server;
#    $SQLSvrObj.ConnectionContext.ConnectTimeout=21600;
#    $SQLSvrObj.ConnectionContext.StatementTimeout=0;
#    $job=$SQLSvrObj.JobServer.Jobs| where {$_.name -eq "ETL_EXRT_Policy_A"}
#}
#until ($job.CurrentRunStatus -eq "Idle")

#-------------------------------------------------------------------------------------#
# 6. Test deployment
#-------------------------------------------------------------------------------------#


. .\06_TestProj.ps1

#-------------------------------------------------------------------------------------#
# 8. Post deployment commands
#-------------------------------------------------------------------------------------#
# Bulk Data transfer 
